# --- HTTP & Networking ---
quarkus.http.root-path=/portal
# Fixed: Newer Quarkus versions use '.enabled'
quarkus.http.cors.enabled=true
quarkus.http.cors.origins=*
quarkus.http.cors.methods=GET,POST,OPTIONS,PUT,DELETE
quarkus.http.cors.headers=Content-Type,Authorization

# --- Database Configuration (PostgreSQL @ Beelink) ---
quarkus.datasource.db-kind=postgresql
quarkus.datasource.username=${DB_USER}
quarkus.datasource.password=${DB_PASS}
quarkus.datasource.jdbc.url=jdbc:postgresql://192.168.100.80:5432/hoa_db
quarkus.hibernate-orm.database.default-schema=hoa

# --- JWT Security (Optimized HS256) ---
quarkus.smallrye-jwt.enabled=true
# Use ANY to ignore issuer mismatches (highly recommended for Docker/Tunnels)
mp.jwt.verify.issuer=ANY

# Verified 32-character secret key mapping
smallrye.jwt.verify.key.format=RAW
smallrye.jwt.verify.key=${JWT_SECRET}
smallrye.jwt.verify.algorithm=HS256

# Identity Mapping & Reliability
mp.jwt.verify.upn-claim=upn
# Allows 5-minute clock drift between Mac and Beelink
smallrye.jwt.verify.clock-skew=300
smallrye.jwt.verify.relax-key-validation=true


# --- Logging (The "Truth" Detector) ---
quarkus.log.level=INFO
# Required to allow TRACE level logs at runtime
quarkus.log.min-level=TRACE
quarkus.log.category."io.smallrye.jwt.auth.principal.DefaultJWTTokenParser".level=TRACE
quarkus.log.category."io.quarkus.security".level=DEBUG

# --- MongoDB & Services ---
quarkus.mongodb.connection-string=mongodb://192.168.100.80:27017
quarkus.mongodb.database=hoa_logs
HASURA_URL=http://192.168.100.80:8080/v1/graphql
HASURA_ADMIN_SECRET=myadminsecretkey

# --- Deep Logging (The "Truth" Detector) ---
quarkus.log.level=INFO
quarkus.log.category."io.smallrye.jwt".level=DEBUG
quarkus.log.category."io.quarkus.security".level=DEBUG
# This line is critical: it will log the EXACT reason for rejection
quarkus.log.category."io.smallrye.jwt.auth.principal.DefaultJWTTokenParser".level=TRACE