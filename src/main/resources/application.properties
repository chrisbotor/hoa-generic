# --- HTTP & Networking ---
quarkus.http.root-path=/portal
quarkus.http.cors=true
#quarkus.http.cors.origins=* quarkus.http.cors.headers=accept, authorization, content-type, x-requested-with
quarkus.http.cors.origins=*
quarkus.http.cors.methods=GET, POST, OPTIONS, PUT, DELETE
quarkus.http.cors.headers=Content-Type,Authorization

# Allow Cloudflare Tunnel access to Dev UI
quarkus.http.dev-ui.hosts=0.0.0.0, .trycloudflare.com

# --- Database Configuration (PostgreSQL @ Beelink) ---
quarkus.datasource.db-kind=postgresql
quarkus.datasource.username=hoa_admin
quarkus.datasource.password=qwertyuiop
quarkus.datasource.jdbc.url=jdbc:postgresql://192.168.100.80:5432/hoa_db

# Use 'hoa' schema for all entities by default
quarkus.hibernate-orm.database.default-schema=hoa

# --- JWT Security (The Fix for "Invalid Token") ---
quarkus.smallrye-jwt.enabled=true
smallrye.jwt.verify.relax-key-validation=true
smallrye.jwt.verify.key.format=RAW
#smallrye.jwt.verify.key=${JWT_SECRET}
#smallrye.jwt.verify.key=ThisIsMy32CharacterSecretKey1234

# Explicitly set to BASE64 to match the code
#smallrye.jwt.verify.key.format=BASE64
smallrye.jwt.verify.key=StationBeelinkSer5ProHOAKey2026!

smallrye.jwt.verify.algorithm=HS256
mp.jwt.verify.issuer=https://hoa-portal.com

# Give a 60-second buffer for time differences between devices
smallrye.jwt.verify.clock-skew=60

# Ensure the sub (subject) is mapped correctly if UPN is missing
mp.jwt.verify.upn-claim=upn



# --- MongoDB (Logs) ---
# Ensure your MongoDB container is running on .80 or this may cause a startup delay
quarkus.mongodb.connection-string=mongodb://192.168.100.80:27017
quarkus.mongodb.database=hoa_logs

# --- External Service Config ---
HASURA_URL=http://192.168.100.80:8080/v1/graphql
HASURA_ADMIN_SECRET=myadminsecretkey

# --- Logging ---
# INFO for general, DEBUG for our custom code and security checks
quarkus.log.level=INFO
quarkus.log.category."io.smallrye.jwt".level=DEBUG
quarkus.log.category."io.quarkus.security".level=DEBUG
quarkus.log.category."com.hoa.portal".level=DEBUG
#